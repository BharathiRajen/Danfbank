{"version":3,"file":"ngx-select2.js","sources":["ng://ngx-select2/select2/select2.component.ts","ng://ngx-select2/ngx-select2.module.ts","ng://ngx-select2/ngx-select2.ts"],"sourcesContent":["import { Component, ViewChild, ElementRef, forwardRef, Input, Output, EventEmitter, SimpleChanges, Renderer2 } from '@angular/core';\r\nimport { NG_VALUE_ACCESSOR, ControlValueAccessor, NG_VALIDATORS, Validator, AbstractControl, ValidationErrors } from '@angular/forms';\r\n\r\ndeclare let $: any;\r\n\r\n@Component({\r\n  selector: 'l-select2',\r\n  templateUrl: './select2.html',\r\n  providers: [\r\n    {\r\n      provide: NG_VALUE_ACCESSOR,\r\n      useExisting: forwardRef(() => LSelect2Component),\r\n      multi: true\r\n    },\r\n    {\r\n      provide: NG_VALIDATORS,\r\n      useExisting: forwardRef(() => LSelect2Component),\r\n      multi: true\r\n    }\r\n  ]\r\n})\r\nexport class LSelect2Component implements ControlValueAccessor, Validator {\r\n\r\n  @ViewChild('selectControll') selectControll: ElementRef;\r\n\r\n  @Input() data: Array<any>;\r\n  @Input() disabled: boolean;\r\n  @Input() options: any = {};\r\n  @Input() required: boolean = false;\r\n  @Input() maxCount: number = Number.MAX_SAFE_INTEGER;\r\n  @Input() minCount: number = Number.MIN_SAFE_INTEGER;\r\n  @Output() valueChange: EventEmitter<any> = new EventEmitter<any>();\r\n\r\n  public selectedValue: any | Array<any>\r\n\r\n  private _jqueryElement: any;\r\n  private _onChange = (_: any) => { };\r\n  private _onTouched = () => { };\r\n\r\n  constructor(\r\n    private _renderer: Renderer2) {\r\n\r\n  }\r\n\r\n  ngOnInit() { }\r\n\r\n  ngAfterViewInit() {\r\n    this._jqueryElement = $(this.selectControll.nativeElement);\r\n    this.initSelect2();\r\n\r\n    this._jqueryElement.on('select2:select select2:unselect', (e: any) => {\r\n      let data = this._jqueryElement.select2('data');\r\n      for (let item of data) {\r\n        delete item.element;\r\n        delete item.disabled;\r\n        delete item.selected;\r\n      }\r\n      if (!this.options.multiple) {\r\n        data = (e.type == 'select2:unselect') ? null : data[0];\r\n      }\r\n      this.selectedValue = data;\r\n      this._onChange(data);\r\n      this.valueChange.emit(data);\r\n    });\r\n    if (this.selectedValue) {\r\n      this.setSelect2Value(this.selectedValue);\r\n    }\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    if (!this._jqueryElement) return;\r\n    if (this.hasChanged(changes)) {\r\n      this.initSelect2();\r\n      if (this.selectedValue) {\r\n        this.setSelect2Value(this.selectedValue);\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this._jqueryElement.select2('destroy');\r\n  }\r\n\r\n  writeValue(value: any | Array<any>): void {\r\n    this.selectedValue = value;\r\n    if (value !== null && value !== undefined)\r\n      this.setSelect2Value(value);\r\n  }\r\n\r\n  registerOnChange(fn: (_: any) => {}): void {\r\n    this._onChange = fn;\r\n  }\r\n\r\n  registerOnTouched(fn: () => {}): void {\r\n    this._onTouched = fn;\r\n  }\r\n\r\n  setDisabledState(isDisabled: boolean) {\r\n    this.disabled = isDisabled;\r\n  }\r\n\r\n  validate(c: AbstractControl): ValidationErrors {\r\n    if (this.disabled) {\r\n      return null;\r\n    }\r\n    let length = this.selectedValue ? this.selectedValue.length : 0;\r\n    if (this.required === true && length === 0) {\r\n      return { required: true };\r\n    }\r\n    if (this.minCount > 0 && length < this.minCount) {\r\n      return { minCount: true };\r\n    }\r\n    if (this.maxCount > 0 && length > this.maxCount) {\r\n      return { maxCount: true };\r\n    }\r\n    return null;\r\n  }\r\n\r\n  public initSelect2() {\r\n    if (this._jqueryElement.hasClass('select2-hidden-accessible') == true) {\r\n      this._jqueryElement.select2('destroy');\r\n      this._renderer.setProperty(this.selectControll.nativeElement, 'innerHTML', '');\r\n    }\r\n\r\n    let options: any = {\r\n      data: this.data\r\n    };\r\n    Object.assign(options, this.options);\r\n    this._jqueryElement.select2(options);\r\n  }\r\n\r\n  private setSelect2Value(value: any | Array<any>) {\r\n    if (!this._jqueryElement || !value) {\r\n      this.selectedValue = value;\r\n      return;\r\n    };\r\n    let targetVal = value['id'] || value;\r\n    if (Array.isArray(value)) {\r\n      targetVal = value.map(x => x['id']);\r\n    }\r\n    this._jqueryElement.val(targetVal).trigger('change');\r\n  }\r\n\r\n  private hasChanged(changes: any) {\r\n    if (changes['data'] && JSON.stringify(changes['data'].previousValue) !== JSON.stringify(changes['data'].currentValue)) {\r\n      return true;\r\n    }\r\n    if (changes['options'] && JSON.stringify(changes['options'].previousValue) !== JSON.stringify(changes['options'].currentValue)) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { LSelect2Component } from './select2/select2.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule\r\n  ],\r\n  declarations: [\r\n    LSelect2Component\r\n  ],\r\n  exports: [\r\n    LSelect2Component\r\n  ]\r\n})\r\nexport class LSelect2Module { }\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}